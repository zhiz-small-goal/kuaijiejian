// 安全保存 - 静默版本（已验证可用 ✅）
try{var desc=new ActionDescriptor();executeAction(charIDToTypeID('save'),desc,DialogModes.NO);}catch(e){try{var doc=app.activeDocument,docName=doc.name,baseName=docName.replace(/\.[^\.]+$/,''),savePath;try{savePath=doc.path;}catch(pe){savePath=Folder.desktop;}var tifFile,counter=0;do{var fileName=baseName+(counter>0?'_'+counter:'')+'.tif';tifFile=new File(savePath+'/'+fileName);if(!tifFile.exists)break;counter++;}while(counter<100);var saveDesc=new ActionDescriptor();saveDesc.putPath(charIDToTypeID('In  '),tifFile);saveDesc.putClass(charIDToTypeID('As  '),charIDToTypeID('TIFF'));executeAction(charIDToTypeID('save'),saveDesc,DialogModes.NO);}catch(se){}}
