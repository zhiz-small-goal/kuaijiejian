<Window x:Class="Kuaijiejian.ActionSelectorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="é€‰æ‹© Photoshop åŠ¨ä½œ" 
        Height="600" 
        Width="370"
        WindowStartupLocation="CenterOwner"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize">

    <Window.Resources>
        <!-- å¤é€‰æ¡†æ ·å¼ - å¡ç‰‡å¼å¸ƒå±€ -->
        <Style x:Key="ActionCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Border Background="#FAFBFC"
                                CornerRadius="8"
                                Padding="16,12"
                                BorderThickness="0">
                            <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- å¤é€‰æ¡† -->
                                    <CheckBox Grid.Column="0"
                                              IsChecked="{TemplateBinding IsChecked}"
                                              VerticalAlignment="Top"
                                              Margin="0,2,12,0"/>
                                    
                                    <!-- å†…å®¹åŒºåŸŸ -->
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="{Binding ActionInfo.ActionName}"
                                                   FontSize="14"
                                                   FontWeight="SemiBold"
                                                   Foreground="#1E293B"
                                                   TextWrapping="Wrap"/>
                                        <TextBlock Text="{Binding ActionInfo.ActionSetName, StringFormat='æ¥è‡ªåŠ¨ä½œé›†ï¼š{0}'}"
                                                   FontSize="12"
                                                   Foreground="#64748B"
                                                   Margin="0,4,0,0"
                                                   TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- æŒ‰é’®æ ·å¼ -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#8b5cf6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#7c3aed"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button" BasedOn="{StaticResource PrimaryButtonStyle}">
            <Setter Property="Background" Value="#e5e7eb"/>
            <Setter Property="Foreground" Value="#374151"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#d1d5db"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <!-- çª—å£æ‹–åŠ¨æ”¯æŒ -->
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40"
                      GlassFrameThickness="0"
                      ResizeBorderThickness="5"
                      UseAeroCaptionButtons="False"/>
    </WindowChrome.WindowChrome>

    <!-- ä¸»å®¹å™¨ -->
    <Border Background="White"
            CornerRadius="15"
            BorderThickness="0"
            ClipToBounds="True"
            MouseLeftButtonDown="Border_MouseLeftButtonDown">
        <Grid ClipToBounds="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- æ ‡é¢˜æ  -->
            <Border Grid.Row="0" 
                    Background="#8b5cf6"
                    CornerRadius="15,15,0,0"
                    Padding="20,12">
                <Grid>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="âš¡" FontSize="18" Margin="0,0,8,0"/>
                        <TextBlock Text="é€‰æ‹© Photoshop åŠ¨ä½œ" 
                                   FontSize="16" 
                                   FontWeight="Bold" 
                                   Foreground="White"
                                   VerticalAlignment="Center"
                                   WindowChrome.IsHitTestVisibleInChrome="False"/>
                    </StackPanel>

                    <Button Content="âœ•"
                            Width="30" Height="30"
                            HorizontalAlignment="Right"
                            Click="CloseButton_Click"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="FontSize" Value="16"/>
                                <Setter Property="Cursor" Value="Hand"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}"
                                                    CornerRadius="6">
                                                <ContentPresenter HorizontalAlignment="Center"
                                                                  VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#E81123"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
            </Border>

            <!-- ä¸»å†…å®¹åŒº -->
            <Grid Grid.Row="1" Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- æç¤ºä¿¡æ¯ -->
                <Border Grid.Row="0" 
                        Background="#eff6ff"
                        CornerRadius="8"
                        BorderThickness="0"
                        Padding="15,12"
                        Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock FontSize="13" Foreground="#1e40af" TextWrapping="Wrap">
                            <Run Text="ðŸ’¡ "/>
                            <Run Text="ä»Ž Photoshop ä¸­æ£€æµ‹åˆ°ä»¥ä¸‹åŠ¨ä½œï¼Œè¯·é€‰æ‹©è¦æ·»åŠ åˆ°ä¸»é¡µé¢çš„åŠ¨ä½œï¼š"/>
                        </TextBlock>
                        <!-- æœç´¢æ¡† -->
                        <Border Background="#F8FAFC" CornerRadius="6" BorderThickness="0" Padding="12,10" Margin="0,10,0,0" Height="42">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- æœç´¢å›¾æ ‡ -->
                                <TextBlock Grid.Column="0" Text="ðŸ”" FontSize="16" VerticalAlignment="Center" 
                                           Margin="0,0,10,0" Foreground="#3b82f6"/>
                                
                                <!-- è¾“å…¥æ¡† -->
                                <TextBox x:Name="SearchBox" Grid.Column="1" BorderThickness="0" Background="Transparent" 
                                         FontSize="14" VerticalAlignment="Center" TextChanged="SearchBox_TextChanged"
                                         Text="" Foreground="#1E293B" FontWeight="Normal">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="TextBox">
                                                        <Grid>
                                                            <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center"/>
                                                            <TextBlock x:Name="PlaceholderText" 
                                                                      Text="è¾“å…¥å…³é”®è¯æœç´¢åŠ¨ä½œ..." 
                                                                      Foreground="#94A3B8" 
                                                                      FontSize="14"
                                                                      VerticalAlignment="Center"
                                                                      IsHitTestVisible="False">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="">
                                                                                <Setter Property="Visibility" Value="Visible"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                                
                                <!-- æ¸…é™¤æŒ‰é’® -->
                                <Button x:Name="ClearSearchButton" Grid.Column="2" Content="âœ•" 
                                        Width="24" Height="24" Margin="8,0,0,0"
                                        Click="ClearSearch_Click" Cursor="Hand"
                                        Visibility="Collapsed">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="#94A3B8"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}" 
                                                                CornerRadius="12"
                                                                BorderThickness="0">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#E2E8F0"/>
                                                    <Setter Property="Foreground" Value="#475569"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- æ“ä½œæŒ‰é’® -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                    <Button Content="å…¨é€‰" 
                            Click="SelectAll_Click"
                            Padding="12,6"
                            Margin="0,0,8,0"
                            Style="{StaticResource SecondaryButtonStyle}"/>
                    <Button Content="å–æ¶ˆå…¨é€‰" 
                            Click="DeselectAll_Click"
                            Padding="12,6"
                            Style="{StaticResource SecondaryButtonStyle}"/>
                    <TextBlock x:Name="CountTextBlock"
                               Text="å·²é€‰æ‹©: 0"
                               VerticalAlignment="Center"
                               Margin="15,0,0,0"
                               FontSize="13"
                               Foreground="#6b7280"/>
                </StackPanel>

                <!-- åŠ¨ä½œåˆ—è¡¨ -->
                <Border Grid.Row="2" 
                        Background="#f9fafb"
                        CornerRadius="8"
                        BorderThickness="0">
                    <Grid>
                        <ScrollViewer VerticalScrollBarVisibility="Auto"
                                      Padding="10">
                            <ItemsControl x:Name="ActionsListBox">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                  DataContext="{Binding}"
                                                  Tag="{Binding}"
                                                  Checked="ActionCheckBox_Changed"
                                                  Unchecked="ActionCheckBox_Changed"
                                                  Style="{StaticResource ActionCheckBoxStyle}"/>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- ç©ºçŠ¶æ€æç¤º -->
                        <StackPanel x:Name="EmptyPanel"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Center"
                                    Visibility="Collapsed">
                            <TextBlock Text="âš ï¸" 
                                       FontSize="48"
                                       HorizontalAlignment="Center"
                                       Opacity="0.3"/>
                            <TextBlock Text="æœªæ£€æµ‹åˆ° Photoshop åŠ¨ä½œ" 
                                       FontSize="14"
                                       Foreground="#9ca3af"
                                       HorizontalAlignment="Center"
                                       Margin="0,10,0,5"/>
                            <TextBlock Text="è¯·ç¡®ä¿ Photoshop å·²æ‰“å¼€å¹¶åŠ è½½äº†åŠ¨ä½œ" 
                                       FontSize="12"
                                       Foreground="#d1d5db"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- åŠ è½½æç¤º -->
                        <StackPanel x:Name="LoadingPanel"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Center"
                                    Visibility="Visible">
                            <TextBlock Text="â³" 
                                       FontSize="48"
                                       HorizontalAlignment="Center"/>
                            <TextBlock Text="æ­£åœ¨ä»Ž Photoshop åŠ è½½åŠ¨ä½œ..." 
                                       FontSize="14"
                                       Foreground="#6b7280"
                                       HorizontalAlignment="Center"
                                       Margin="0,10,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <!-- åº•éƒ¨æŒ‰é’® -->
            <Border Grid.Row="2" 
                    Background="#f9fafb"
                    BorderBrush="#e5e7eb"
                    BorderThickness="0,1,0,0"
                    CornerRadius="0,0,15,15"
                    Padding="20,15">
                <StackPanel Orientation="Horizontal" 
                            HorizontalAlignment="Right">
                    <Button Content="å–æ¶ˆ" 
                            Click="CloseButton_Click"
                            Margin="0,0,10,0"
                            Style="{StaticResource SecondaryButtonStyle}"/>
                    <Button Content="æ·»åŠ é€‰ä¸­çš„åŠ¨ä½œ" 
                            Click="AddButton_Click"
                            Style="{StaticResource PrimaryButtonStyle}"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>


